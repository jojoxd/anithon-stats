{
	"extends": [
		"../../.eslintrc.json",
		"plugin:boundaries/strict"
	],
	"plugins": [
		"boundaries",
		"import"
	],
	"env": {
		"node": true,
		"es6": true
	},
	"parser": "@typescript-eslint/parser",
	"ignorePatterns": [
		"!**/*",
		"node_modules/"
	],
	"settings": {
		"import/resolver": {
			"typescript": {
				"alwaysTryTypes": true
			}
		},
		"boundaries/elements": [
			{
				"type": "entry-points",
				"pattern": [
					"apps/backend/src/main.ts",
					"apps/backend/src/Server.ts"
				],
				"mode": "file"
			},
			{
				"type": "barrels",
				"pattern": [
					"apps/backend/src/application/controller/api/index.ts",
					"apps/backend/src/application/scheduler/index.ts",
					"apps/backend/src/application/service/index.ts",
					"apps/backend/src/domain/entity/index.ts",
					"apps/backend/src/domain/graphql/anilist/list/index.ts",
					"apps/backend/src/domain/graphql/anilist/series/index.ts",
					"apps/backend/src/domain/graphql/anilist/user/index.ts",
					"apps/backend/src/domain/repository/index.ts",
					"apps/backend/src/domain/service/index.ts"
				],
				"mode": "file"
			},
			{
				"type": "application-layer",
				"pattern": "apps/backend/src/application/*/**/*.ts",
				"mode": "file",
				"capture": ["category"]
			},
			{
				"type": "domain-layer",
				"pattern": "apps/backend/src/domain/*/**/*.ts",
				"mode": "file",
				"capture": ["category"]
			},
			{
				"type": "tsed-config",
				"pattern": "apps/backend/src/config/**/*",
				"mode": "file"
			},
			{
				"type": "command",
				"pattern": "apps/backend/src/bin/**/*",
				"mode": "file"
			},
			{
				"type": "migrations",
				"pattern": "apps/backend/src/migrations/**/*",
				"mode": "file"
			}
		],
		"boundaries/include": [
			"apps/backend/src/**/*.ts"
		],
		"boundaries/ignore": []
	},
	"rules": {
		"boundaries/element-types": [2, {
			"default": "disallow",
			"message": "Code Stink: ${file.type} is not allowed to import ${dependency.type}",

			"rules": [
				{
					"from": ["entry-points"],
					"allow": [
						"barrels",
						"entry-points"
					],
					"message": "Don't import generated barrels as it will break import order"
				},
				{
					"from": [
						["application-layer", { "category": "controller" }]
					],
					"allow": [
						["application-layer", { "category": "service" }],
						["application-layer", { "category": "controller" }]
					],
					"message": "Code Stink: ${file.type} (${file.category}) is not allowed to import ${dependency.type}"
				},
				{
					"from": [
						["application-layer", { "category": "service" }],
						["application-layer", { "category": "protocol" }]
					],
					"allow": [
						"application-layer"
					],
					"message": "Code Stink: ${file.type} (${file.category}) is not allowed to import ${dependency.type}"
				},
				{
					"from": ["application-layer", "command"],
					"allow": ["domain-layer"]
				},
				{
					"from": "domain-layer",
					"allow": "domain-layer"
				},
				{
					"from": ["application-layer", "domain-layer", "command", "tsed-config"],
					"allow": ["tsed-config"]
				},
				{
					"from": "controller",
					"allow": ["controller", "application-services"]
				}
			]
		}]
	},
	"overrides": [
		{
			"files": [
				"*.ts"
			]
		}
	]
}
